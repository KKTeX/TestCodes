%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[8pt,b5paper,twoside]{ltjsreport}
\usepackage[top=16truemm,bottom=14truemm,left=12truemm,right=12truemm]{geometry}%（電子書籍はこっち）
% \usepackage[top=16truemm,bottom=14truemm,outer=15truemm,inner=18truemm]{geometry}%（紙の書籍はこっち）
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%パッケージ関連%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/packages-v1.0}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/colors-v1.0}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/luatex-hiragino-v1.3}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/pre-KKawaguchi-v2.0}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/stfile-of-KKwaguchi-v1.6}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/sectioncustomize2}
% \usepackage[usetype1]{/Users/majinkuu/Documents/TeXDevelop/styles2/使わないstyファイル/myuline--}
% \usepackage{background}
\usepackage{/Users/majinkuu/Documents/TeXDevelop/styles2/answerbox}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NewDocumentCommand\myKaitouran{m O{#1} O{20} O{5mm}}{
  \def\kazu{#1}% 描画枠の数
  \def\haba{#3}% 横の枠幅(省略時規定値 20)
  \def\myunit{#4}% 一つの枠の大きさ(規定値5mm)
  \def\saishou{#2}
  %%
  \begin{tikzpicture}[x=\myunit,y=\myunit]

    \pgfmathint   { 0                          } \let \xmin = \pgfmathresult
    \pgfmathparse { int(mod( \kazu, \haba ))   } \let \xmid = \pgfmathresult
    \pgfmathparse { int(min( \kazu, \haba ))   } \let \xmax = \pgfmathresult

    \pgfmathint   { 0                          } \let \ymin = \pgfmathresult
    \pgfmathint   { 1                          } \let \ymid = \pgfmathresult
    \pgfmathint   { (\kazu + \haba -1) / \haba } \let \ymax = \pgfmathresult

    \pgfmathparse { int(mod(\saishou,\haba))   } \let \amasai = \pgfmathresult
    \pgfmathparse { int(\saishou/\haba)        } \let \shousai = \pgfmathresult

    \pgfmathtruncatemacro\trow{ceil(\kazu/\haba)}
    \pgfmathtruncatemacro\kazuEqualsSaishou{ifthenelse(\kazu==\saishou, 1, 0)}
    \pgfmathtruncatemacro\habas{ifthenelse(\kazu <= \haba, 0, \haba)}

    \ifnum \xmid = 0 \pgfmathint { 0 } \let\ymid=\pgfmathresult \fi % ちょっと苦しい

    \message{myMath #1 #3 ymin=\ymin , ymid=\ymid ,ymax=\ymax ====}

    \coordinate (A) at ( \xmin, \ymin );
    \coordinate (B) at ( \xmin, \ymax );
    \coordinate (C) at ( \xmax, \ymax );
    \coordinate (D) at ( \xmax, \ymid );
    \coordinate (G) at ( \amasai, \trow-\shousai-1);
    \coordinate (H) at ( \amasai, \trow-\shousai);
    \coordinate (I) at ( \habas, \trow-\shousai);
    \coordinate (J) at ( 0, \trow-\shousai-1);

    \ifnum \xmid = 0
        % \draw[step=1] (A) grid (C);
        \foreach \y in {\ymin, ..., \ymax} {
          \draw[thin,dashed] (\xmin, \y) -- (\xmax, \y);
        }
        \draw[thick ] (A) -- (B) -- (C) -- (D) -- cycle;
        \ifnum\kazuEqualsSaishou=0
          \draw[thick] (H) -- (G);
        \fi
        \draw[thick] (H) -- (I);
        \draw[thick] (G) -- (J);
    \else%%%%%%%%
        \coordinate (E) at ( \xmid, \ymid );
        \coordinate (F) at ( \xmid, \ymin );
        % \draw[step=1] (A) grid ( \xmid, \ymax );
        % \draw[step=1] ( \xmid, \ymid ) grid (C);
        % 横線のみ描画
        \foreach \y in {\ymin, ..., \ymax} {
          \draw[thin,dashed] (\xmin, \y) -- (\xmid, \y);
        }
        \foreach \y in {\ymid, ..., \ymax} {
          \draw[thin,dashed] (\xmid, \y) -- (\xmax, \y);
        }
        \draw[thick ] (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \ifnum\kazuEqualsSaishou=0
          \draw[thick] (H) -- (G);
        \fi
        \draw[thick] (H) -- (I);
        \draw[thick] (G) -- (J);
    \fi
    \ifnum \xmax > 10
        % \foreach \x in { 5, 10,..., \xmax }
        % \draw (\x - .5 , \ymax + .6 ) node[anchor=north] {\footnotesize\x};
        \ifnum\kazuEqualsSaishou=0
          \draw[thick] (H) -- (G);
        \fi
        \draw[thick] (G) -- (J);
    \else
        % \foreach \x in { 5, 10 }
        % \draw (\x - .5 , \ymax + .6 ) node[anchor=north] {\footnotesize\x};
        \ifnum\kazuEqualsSaishou=0
          \draw[thick] (H) -- (G);
        \fi
        \draw[thick] (G) -- (J);
    \fi
  \end{tikzpicture}
}

\begin{document}
\begin{ansbox}[Swidth=70mm]
\pbox[3]{5}[Swidth=7mm]
\pbox{3}[Swidth=7mm]%多分7がちょうどいいくらい
\end{ansbox}

\vskip2mm\begin{minipage}[c]{.7\columnwidth}
  \begin{ansbox}[height=8mm,Schar=ア]
  \pbox[1]{5}
  \ptxt{1}{l}{\markeggsMath}
  \ptxt{2}{l}{\markeggsMath}
  \end{ansbox}
\end{minipage}

\end{document}
